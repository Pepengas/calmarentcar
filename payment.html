<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Payment - Calma Car Rental</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Payment page specific styles */
    .payment-section {
      padding-top: 120px;
      padding-bottom: 80px;
    }

    .payment-container {
      max-width: 800px;
      margin: 0 auto;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      padding: 30px;
    }

    .payment-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .payment-header h1 {
      font-size: 2rem;
      color: #0066cc;
      margin-bottom: 10px;
    }

    .payment-header p {
      color: #666;
      font-size: 1rem;
    }

    .payment-summary {
      background-color: #f8f9fa;
      border-left: 4px solid #0066cc;
      padding: 20px;
      border-radius: 4px;
      margin-bottom: 30px;
    }

    .summary-title {
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 1.2rem;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .summary-item:last-child {
      border-bottom: none;
    }

    .summary-label {
      font-weight: 600;
    }

    .total-row {
      font-size: 1.2rem;
      font-weight: 700;
      color: #0066cc;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 2px solid #eee;
    }

    .payment-methods {
      margin-bottom: 30px;
    }

    .payment-methods h3 {
      margin-bottom: 15px;
      font-size: 1.2rem;
    }

    .payment-icons {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }

    .payment-icon {
      font-size: 2rem;
      color: #666;
    }

    .payment-security {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 4px;
      margin-bottom: 30px;
    }

    .security-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .security-header i {
      color: #28a745;
      font-size: 1.2rem;
    }

    .security-header h4 {
      margin: 0;
      font-size: 1rem;
    }

    .security-text {
      font-size: 0.9rem;
      color: #666;
    }

    .btn-pay {
      background-color: #0066cc;
      color: white;
      padding: 15px 30px;
      font-size: 1.1rem;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
      transition: background-color 0.3s;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }

    .btn-pay:hover {
      background-color: #0055aa;
    }

    .btn-pay:disabled {
      background-color: #7da7d9;
      cursor: not-allowed;
    }

    .action-buttons {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    .back-to-summary {
      color: #666;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-size: 0.9rem;
      margin-top: 15px;
    }

    .back-to-summary:hover {
      color: #0066cc;
    }

    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .spinner {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #0066cc;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <a href="index.html" aria-label="Calma Car Rental Home">
            <img src="images/CalmaLogo.png" alt="Calma Car Rental Logo" width="120" height="40">
          </a>
        </div>
        <nav>
          <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="index.html#cars">Our Cars</a></li>
            <li><a href="index.html#locations">Locations</a></li>
            <li><a href="index.html#about">About Us</a></li>
            <li><a href="index.html#faq">FAQ</a></li>
            <li><a href="index.html#contact">Contact</a></li>
          </ul>
        </nav>
        <div class="header-actions">
          <button class="mobile-menu" aria-expanded="false" aria-label="Toggle mobile menu">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Progress steps -->
  <div class="progress-container container" style="margin-top: 120px;">
    <div class="progress-steps">
      <div class="step completed">1</div>
      <div class="step completed">2</div>
      <div class="step completed">3</div>
      <div class="step active">4</div>
    </div>
    <div class="step-titles">
      <div class="step-title">Car Selection</div>
      <div class="step-title">Date & Location</div>
      <div class="step-title">Personal Info</div>
      <div class="step-title active">Payment</div>
    </div>
  </div>

  <!-- Payment Section -->
  <section class="payment-section">
    <div class="container">
      <div class="payment-container">
        <div class="payment-header">
          <h1>Complete Your Booking</h1>
          <p>Please review your booking details and proceed to payment</p>
        </div>

        <!-- Payment Summary -->
        <div id="payment-summary" class="payment-summary">
          <h2 class="summary-title">Booking Summary</h2>
          
          <div class="summary-item">
            <span class="summary-label">Car:</span>
            <span id="car-name">Loading...</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Pick-up:</span>
            <span id="pickup-details">Loading...</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Drop-off:</span>
            <span id="dropoff-details">Loading...</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Duration:</span>
            <span id="rental-duration">Loading...</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Daily Rate:</span>
            <span id="daily-rate">Loading...</span>
          </div>
          
          <div class="summary-item total-row">
            <span class="summary-label">Total:</span>
            <span id="total-amount">€0.00</span>
          </div>
        </div>

        <!-- Payment Methods -->
        <div class="payment-methods">
          <h3>Secure Payment</h3>
          <div class="payment-icons">
            <i class="fab fa-cc-visa payment-icon"></i>
            <i class="fab fa-cc-mastercard payment-icon"></i>
            <i class="fab fa-cc-amex payment-icon"></i>
            <i class="fab fa-cc-discover payment-icon"></i>
          </div>
          
          <div class="payment-security">
            <div class="security-header">
              <i class="fas fa-lock"></i>
              <h4>Secure Transaction</h4>
            </div>
            <p class="security-text">Your payment information is encrypted and securely processed by Stripe. We do not store your card details.</p>
          </div>
        </div>

        <!-- Payment Button -->
        <button id="pay-now-button" class="btn-pay">
          <i class="fas fa-credit-card"></i>
          Pay Now
        </button>
        
        <div class="action-buttons">
          <a href="personal-info.html" class="back-to-summary">
            <i class="fas fa-arrow-left"></i>
            Back to Personal Information
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Loading Overlay -->
  <div class="loading-overlay">
    <div class="spinner"></div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-logo">
          <img src="images/CalmaLogo.png" alt="Calma Car Rental Logo" width="120" height="40">
        </div>
        <div class="footer-links">
          <div class="footer-column">
            <h3>Quick Links</h3>
            <ul>
              <li><a href="index.html">Home</a></li>
              <li><a href="index.html#cars">Our Cars</a></li>
              <li><a href="index.html#locations">Locations</a></li>
              <li><a href="index.html#about">About Us</a></li>
            </ul>
          </div>
          <div class="footer-column">
            <h3>Support</h3>
            <ul>
              <li><a href="index.html#faq">FAQ</a></li>
              <li><a href="index.html#contact">Contact Us</a></li>
              <li><a href="#">Terms & Conditions</a></li>
              <li><a href="#">Privacy Policy</a></li>
            </ul>
          </div>
          <div class="footer-column">
            <h3>Contact</h3>
            <ul>
              <li><a href="tel:+306912345678"><i class="fas fa-phone"></i> +30 691 234 5678</a></li>
              <li><a href="mailto:info@calmarental.com"><i class="fas fa-envelope"></i> info@calmarental.com</a></li>
              <li><a href="#"><i class="fas fa-map-marker-alt"></i> Chania, Crete, Greece</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2023 Calma Car Rental. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script type="module">
    import { initPayment } from './js/payment.js';
    
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize payment component
      initPayment();
      
      // Populate booking summary with saved data
      const savedBookingData = localStorage.getItem('currentBooking');
      if (savedBookingData) {
        const data = JSON.parse(savedBookingData);
        
        // Display car details
        const carNameEl = document.getElementById('car-name');
        if (carNameEl && data.car && data.car.name) {
          carNameEl.textContent = data.car.name;
        }
        
        // Display pickup details
        const pickupEl = document.getElementById('pickup-details');
        if (pickupEl) {
          const pickupDate = new Date(data['pickup-date']);
          const pickupDateStr = pickupDate.toLocaleDateString('en-US', { 
            year: 'numeric', month: 'short', day: 'numeric' 
          });
          pickupEl.textContent = `${data['pickup-location']} - ${pickupDateStr}, ${data['pickup-time']}`;
        }
        
        // Display dropoff details
        const dropoffEl = document.getElementById('dropoff-details');
        if (dropoffEl) {
          const dropoffDate = new Date(data['dropoff-date']);
          const dropoffDateStr = dropoffDate.toLocaleDateString('en-US', { 
            year: 'numeric', month: 'short', day: 'numeric' 
          });
          dropoffEl.textContent = `${data['dropoff-location']} - ${dropoffDateStr}, ${data['dropoff-time']}`;
        }
        
        // Calculate and display duration
        const durationEl = document.getElementById('rental-duration');
        if (durationEl) {
          const pickupDate = new Date(data['pickup-date']);
          const dropoffDate = new Date(data['dropoff-date']);
          const days = Math.ceil((dropoffDate - pickupDate) / (1000 * 60 * 60 * 24));
          durationEl.textContent = `${days} ${days === 1 ? 'day' : 'days'}`;
        }
        
        // Display daily rate
        const rateEl = document.getElementById('daily-rate');
        if (rateEl && data.car && data.car.pricePerDay) {
          rateEl.textContent = `€${data.car.pricePerDay}/day`;
        }
      }
    });
  </script>
</body>
</html> 